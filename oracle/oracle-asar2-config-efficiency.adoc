---
sidebar: sidebar 
permalink: oracle/oracle-asar2-config-efficiency.html 
keywords: oracle, efficiency, compression, compaction, deduplication, ASA r2 
summary: 使用ASA r2 提升 Oracle 数据库和存储效率 
searchtitle: Oracle 数据库和ONTAP与ASA r2 的效率特性 
---
= 效率
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
ONTAP 的空间效率功能已得到全面支持，并针对ASA r2 系统进行了优化。在几乎所有情况下，最佳做法是保留默认设置并启用所有效率功能。

ASA r2 系统是全闪存 SAN 平台，因此压缩、精简和重复数据删除等效率技术对于最大限度地提高可用容量和降低成本至关重要。



== 压缩

压缩通过对数据中的模式进行编码来减少空间需求。采用基于 SSD 的ASA r2 系统，压缩可显著节省成本，因为闪存消除了为提高性能而过度配置的需要。ONTAP自适应压缩默认启用，并已使用企业工作负载（包括 Oracle 数据库）进行了全面测试，即使在延迟以微秒为单位测量的环境中，也没有可衡量的性能影响。在某些情况下，由于压缩数据占用更少的缓存空间，性能会得到提升。


NOTE: 温度敏感存储效率 (TSSE) 不适用于ASA r2 系统。在ASA r2 系统中，压缩不是基于热数据（经常访问的数据）或冷数据（不经常访问的数据）。压缩无需等待数据冷却即可开始。



== 自适应数据压缩

自适应压缩默认使用 8KB 的块大小，与关系数据库常用的块大小相匹配。较大的块大小（16KB 或 32KB）可以提高顺序数据（如事务日志或备份）的效率，但对于活动数据库应谨慎使用，以避免在覆盖期间产生开销。


NOTE: 对于日志或备份等静止文件，块大小可以增加到 32KB。更改默认设置前，请先查阅NetApp指南。


CAUTION: 不要对流式备份使用 32KB 压缩和去重功能。使用 8KB 压缩以保持去重效率。



== 数据压缩对齐

对于随机覆盖，压缩对齐很重要。确保 LUN 类型正确、分区偏移量（8KB 的倍数）以及文件系统块大小与数据库块大小一致。备份或日志等顺序数据不需要考虑对齐问题。



== 数据缩减

压缩是对压缩的补充，它允许多个压缩块共享同一个物理块。例如，如果一个 8KB 的数据块压缩到 1KB，压缩可以确保剩余空间不会被浪费。此功能为内联功能，不会造成性能损失。



== 重复数据删除

去重操作会移除数据集中的重复数据块。虽然 Oracle 数据库由于具有独特的块头和块尾，通常只能节省极少的重复数据，但ONTAP重复数据删除仍然可以从零块和重复模式中回收空间。



== 效率和精简配置

ASA r2 系统默认使用精简配置。效率特性与精简配置相辅相成，可最大限度地利用可用容量。


NOTE: 在ASA r2 存储系统上，存储单元始终采用精简配置。不支持厚配置。



== 快速辅助技术（QAT）

在NetApp ASA r2 平台上，Intel QuickAssist 技术 (QAT) 提供硬件加速的效率，这与没有 QAT 的基于软件的温度敏感存储效率 (TSSE) 有很大不同。

*支持硬件加速的快速访问终端 (QAT)：*

* 将压缩和加密任务从 CPU 核心卸载。
* 能够立即提高热数据（频繁访问的数据）和冷数据（不频繁访问的数据）的在线处理效率。
* 显著降低CPU占用率。
* 提供更高的吞吐量和更低的延迟。
* 提高了对性能要求较高的操作（例如 TLS 和 VPN 加密）的可扩展性。


*不含QAT的TSSE：*

* 依靠CPU驱动的进程来实现高效运行。
* 仅对延迟后的冷数据应用效率优化。
* 消耗更多CPU资源。
* 与 QAT 加速系统相比，整体性能受到限制。


因此，现代ASA r2 系统比旧式的仅支持 TSSE 的平台具有更快的硬件加速效率和更好的系统利用率。



== ASA r2 的效率最佳实践

* NetApp建议*：



=== ASA r2 默认值

在ASA r2 系统上运行的ONTAP上创建的存储单元采用精简配置，默认情况下启用所有内联效率功能，包括压缩、精简和重复数据删除。尽管 Oracle 数据库通常不会从重复数据删除中获益匪浅，并且可能包含不可压缩的数据，但这些默认设置几乎适用于所有工作负载。ONTAP旨在高效处理所有类型的数据和 I/O 模式，无论它们是否能带来节省。只有在完全了解原因并且偏离默认设置有明显好处的情况下，才应该更改默认设置。



=== 一般建议

* 禁用加密或应用程序压缩数据的压缩：如果文件已经在应用程序级别压缩或加密，请禁用压缩以优化性能并允许在其他存储单元上更高效地运行。
* 避免将大压缩块与重复数据删除结合使用：不要在数据库备份中同时使用 32KB 压缩和重复数据删除。对于流式备份，请使用 8KB 压缩以保持去重效率。
* 监控效率节省：使用ONTAP工具（系统管理器、 Active IQ）跟踪实际的空间节省情况，并在需要时调整策略。

